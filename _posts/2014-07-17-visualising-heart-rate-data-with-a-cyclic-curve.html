---
layout: post
title: Visualising heart rate data with a cyclic curve
date: 2014-07-17
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
<div dir="ltr">Certain kind of data are cyclical by nature - in the sense that their values repeat after a certain period of time. For these, we could pool all the data points into the same interval and draw a curve through them. This curve would have to satisfy the requirements:</div><div dir="ltr"></div><ul><li>having the same values at the start and end of the interval</li><li>having the same first derivatives (slopes) at the start and end of the interval</li><li>having the same second derivatives (rate of change) at the start and end of the interval (note: this requirements is perhaps not necessary as some curves I've experimented with look "good" even with just the first two requirements met)</li></ul><br /><div dir="ltr">As I'm interested in continuous heart rate tracking, I've tracked my heart rate for several consecutive days, to see what kind of data I get. For this I used the <a href="http://zephyranywhere.com/products/hxm-bluetooth-heart-rate-monitor/" target="_blank">Zephyr HxM BT</a>&nbsp;connected to my Android phone using the <a href="http://tecvis.co.uk/software/airs" target="_blank">AIRS</a> app to log data.&nbsp;</div><div dir="ltr"><br /></div><div dir="ltr">I pooled the logged heart rate from several days and plotted a curve through the data. To demonstrate the concept for the Amsterdam&nbsp;<a href="http://quantifiedself.com/" target="_blank">Quantified Self</a> conference I've built a <a href="http://shiny.rstudio.com/" target="_blank">shiny</a> web app. A demo is available at&nbsp;<a href="http://glimmer.rstudio.com/crtahlin/QS2014/">http://glimmer.rstudio.com/crtahlin/QS2014/</a>. The demo loads a couple of days of data&nbsp;&nbsp;to experiment with (wait ~10 seconds for it to load and draw the first curve). <a href="http://ggplot2.org/" target="_blank">ggplot2</a> is used for plotting and a cyclic GAM smoother curve (R package<span style="font-family: inherit;"> <a href="http://cran.r-project.org/web/packages/mgcv/index.html" target="_blank">mgcv</a>)</span> is drawn on the plots along with the data points.</div><div dir="ltr"><br /></div><div dir="ltr">As mentioned, I've also played around on the data with some of my own curves (cyclic cubic polynomials, cyclic fractional polynomials), but these aren't (yet?) implemented in a function. I plan to make these when time permits although I do not know if/when I will be updating the app with them. If anything, I should probably first add the option to upload heart rate data as CSV the app.</div><div dir="ltr"><br /></div><div dir="ltr">The code for the app can be found on <a href="https://github.com/crtahlin/QS2014" target="_blank">GitHub</a>. The example plot shows about a week of pooled heart rate data (sampled with 1Hz; a random subset is used for faster plotting).</div><div dir="ltr"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-o_hqsrr_Ffg/U8fNf-2bODI/AAAAAAAABmQ/KO5GE-skOGU/s1600/CyclicDailyHR.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-o_hqsrr_Ffg/U8fNf-2bODI/AAAAAAAABmQ/KO5GE-skOGU/s1600/CyclicDailyHR.png" height="382" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;">Some outliers/spikes are visible in raw data - these are most probably measurement errors (loose chest belt, spikes after putting the chest belt on, etc.). The cyclic curve shows a couple of levels of activity (sleep time, awake time, some ups&amp;downs during the day).</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Note: I found continuously measuring heart rate with a chest belt is actually quite error prone and uncomfortable for longer periods, so I'm looking forward to new technologies for a better way.</div><div dir="ltr"><br /></div></div>
<h2>Comments</h2>
<div class='comments'>
</div>
