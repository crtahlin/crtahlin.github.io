---
layout: post
title: MS Excel + RExcel + shiny R package : sending data from Excel to R and displaying the plot in a web browser
date: 2013-09-17
comments: false
tags: code, R, RExcel, shiny
---

<!--
<h1>{{ page.title }}</h1>
-->
<div class='post'>
Excel is a very popular tool and a lot of people use it to store data. <a href="http://cran.r-project.org/web/packages/shiny/index.html">shiny </a>is a package for the R programming language that allows us to interface with R through a web browser.<br /><div><br /></div><div>I will write down a procedure for sending data from Excel to R and running shiny to further work on the data (plot it, in my case). This might not be the best option for transferring data from Excel to R (or shiny), but I will try to describe it, lest it be forgotten.</div><div><br /></div><div>You will need (besides Excel and R) the <a href="http://www.statconn.com/products.html#RExcel">RExcel "plugin"</a> for Excel, which connects Excel with R, enabling exchange of data and commands. Some other connectors also have to be installed, but refer to the docs of the plugin for details.&nbsp;</div><div><br /></div><div>In the VBA window (accessible by right-clicking on an Excel worksheet tab and selecting to edit the VBA code), you will need to set one of the references (Tools -&gt; Referencs) to RExcelVBAlib as in screenshot bellow.</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-g9ONINbE0kw/UjgXN0qVn4I/AAAAAAAABXQ/bHxalEG26Y4/s1600/references.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="259" src="http://3.bp.blogspot.com/-g9ONINbE0kw/UjgXN0qVn4I/AAAAAAAABXQ/bHxalEG26Y4/s320/references.PNG" width="320" /></a></div><div><br /></div><div>Then, you will need to write the VBA code to have a button labeled "Run Shiny" in the toolbar that the user can click and start the process of sending data from Excel to R and starting shiny. E.g.:</div><div><br /></div><div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">' creates toolbar with buttons for generating graphs in R</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">Public Sub createToolbar()</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; On Error Resume Next</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Dim toolbarRExcel2 As CommandBar</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Dim buttonRunShiny As CommandBarButton</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Dim buttonStopRServer As CommandBarButton</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Dim buttonInstallMedplot As CommandBarButton</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Set toolbarRExcel2 = CommandBars.Add("RIntegration2")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; toolbarRExcel2.Visible = True</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><span style="background-color: yellow;">&nbsp; &nbsp; Set buttonRunShiny = toolbarRExcel2.Controls.Add(Type:=msoControlButton)</span></span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; With buttonRunShiny</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .Caption = "Run Shiny"</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .Style = msoButtonCaption</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .OnAction = "runShiny"</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; End With</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Set buttonStopRServer = toolbarRExcel2.Controls.Add(Type:=msoControlButton)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; With buttonStopRServer</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .Caption = "Stop R server"</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .Style = msoButtonCaption</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .OnAction = "stopRServer"</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; End With</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Set buttonInstallMedplot = toolbarRExcel2.Controls.Add(Type:=msoControlButton)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; With buttonInstallMedplot</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .Caption = "Update medplot R package"</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .Style = msoButtonCaption</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; .OnAction = "installMedplot"</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; End With</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;MsgBox "Created RExcel integration toolbar"</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">End Sub</span></div></div><div><br /></div><div>(I just copied the whole block of my code - only the yellow part is relevant for the button in question.) Next, write the code that will send the data from Excel into R (and shiny), that executes after the button "Run Shiny" is pressed. Here comes the catch - since shiny runs until it is somehow stopped (for example by closing the browser window), Excel will seem to freeze if it just waits for the shiny process to finish. That's why some of the complications that follow were implemented : for Excel to start a separate R process (with shiny) that runs in the background, so the user can continue working in Excel. Data and settings are passed to R, an R script file "Symptoms.R" is called that saves these for the next, "background", session of R and then the background session of R is started by calling "Run.R" script. The relevant code bellow is colored yellow.&nbsp;</div><div><br /></div><div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">' send data to R</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">Sub runShiny()</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; On Error GoTo ErrRServerStart:</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; RInterface.SetServerType (stLocalForeground)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Call RInterface.StartRServer</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; On Error Resume Next</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Dim lastRow As Integer</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Dim lastColumn As Integer</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' clear the sheet with error messages</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Sheets("ERRORS").Cells.Clear</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: 'Courier New', Courier, monospace;"><span style="font-size: xx-small;">&nbsp; &nbsp; ' check if scripts (working) directory exists; reference is by cell name</span></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' if it does not exist, exit the procedure</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; If Dir([workingDir], vbDirectory) = vbNullString Then</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; MsgBox ("The R scripts folder " &amp; [workingDir] &amp; _</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; " does not exist. Correct the path on the SETTINGS worksheet.")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; Exit Sub</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; End If</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' check if scripts directory contains Symptoms.R file</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; If Dir([workingDir] &amp; "\Symptoms.R", vbNormal) = vbNullString Then</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; MsgBox ("The R scripts folder " &amp; [workingDir] &amp; _</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; " does not contain Symptoms.R file. Check the path on the SETTINGS worksheet.")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; Exit Sub</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; End If</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;' check if executables directory contains Rscript.exe file</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; If Dir([executablesDir] &amp; "\Rscript.exe", vbNormal) = vbNullString Then</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; MsgBox ("The R executable file folder " &amp; [executablesDir] &amp; _</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; " does not contain Rscript.exe file. Check the path on the SETTINGS worksheet.")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; Exit Sub</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; End If</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; On Error Resume Next</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' kill all runnning Rscript processes (otherwise the graph does not refresh with new data immediatelly)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' if this turns out to be a problem, due to "unwanted" killings, IDs of previous Rscript session could</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' be implemented to be kept in a file and only those process IDs in file killed</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Call killRscriptProcess</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' find last row and column of data</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; lastRow = findLastRow(Worksheets("DATA"), "A")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; lastColumn = findLastColumn(Worksheets("DATA"), 1)</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' import dataframe of DATA</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; RInterface.PutDataframe "mySymptomsData", Sheets("DATA").Range( _</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; Sheets("DATA").Cells(1, 1), _</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp; Sheets("DATA").Cells(lastRow, lastColumn)), False</span></div><div><span style="font-size: xx-small;"><span style="font-family: Courier New, Courier, monospace;">&nbsp; &nbsp;&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">&nbsp; &nbsp;&nbsp;</span></span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp;' set the working directory</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; RInterface.RRun ("workingDir &lt;- " &amp; Chr(34) &amp; Replace([workingDir], "\", "/") &amp; Chr(34))</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; RInterface.RRun "setwd(workingDir)"</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' run the R file with the functions</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; RInterface.RRun "source('Symptoms.R')"</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Dim RetVal</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; ' run the Shiny server in another process- so Excel does not wait for it to finish</span></div><div><span style="background-color: yellow; font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; RetVal = Shell(([executablesDir] &amp; "\Rscript.exe " &amp; """" &amp; [workingDir] &amp; "\Run.R" &amp; """"))</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; &nbsp; &nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Exit Sub</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">ErrRServerStart:</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; MsgBox ("R Server could not be started. RExcel macros will not be available.")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Resume Next</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">ErrCreatingDirectory:</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; MsgBox ("Folder could not be created. Try specifying a different folder name.")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp; Resume AtTheEnd:</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">AtTheEnd:</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; &nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">End Sub</span></div></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: inherit;">The R script file "Symptoms.R" called by RExcel in the above code actually creates the other R script file "Run.R" that contains all information needed for the background R session: the data, the settings, the command to run shiny. E.g.:</span></div><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">Symptoms.R file</span></div><div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># This file gets called from RExcel, to prepare the data</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># needed by shiny.</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># load library for melting data</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">library(reshape2)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># transform date information into R compliant dates</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">mySymptomsData["Date"] &lt;- as.Date(mySymptomsData[,"Date"], "%d.%m.%Y")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># transform data into ggplot compliant format</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">symptomsData &lt;- melt(mySymptomsData, id.vars = c("Patient", "Date"))</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># save data to file to share with the R session that will run shiny</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">save.image(file="data.Rdata")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># get the working directory</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">workingDir &lt;- getwd()</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># generate script, which contains information to start the shiny server.</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">script &lt;- paste(</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; "</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; # This script is automatically generated by Symptoms.R</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; # and is not meant to be edited by user.</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; # load library used for ploting</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; library(ggplot2)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; # set working directory</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; setwd(\"", workingDir &nbsp; ,"\")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; # load data saved from Excel</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; load(\"data.Rdata\")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; #load library shiny for HTML drawing and run shiny</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; library(shiny)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; runApp(launch.browser=TRUE)</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp;&nbsp;</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; "</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">&nbsp; , sep="")</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"><br /></span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># save script as Run.R</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;"># Run.R will be called by RExcel process.</span></div><div><span style="font-family: Courier New, Courier, monospace; font-size: xx-small;">writeLines(script, con="Run.R")</span></div><div style="font-family: inherit;"><br /></div></div><div><span style="font-family: inherit;">The Run.R file generated in this way is the one which is finally called by RExcel in the VBA code above, to start the&nbsp;</span>background<span style="font-family: inherit;">&nbsp;shiny process.&nbsp;</span></div><div><span style="font-family: inherit;"><br /></span><span style="font-family: inherit;">To recap the point: send data from Excel to R; use R to save the data and create another R script which contains all relevant info for running a shiny process; start another R process in the background through this script.</span><br /><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;">This process was implemented in the </span><a href="https://github.com/crtahlin/medplot" style="font-family: inherit;">medplot </a><span style="font-family: inherit;">package, but will probably be&nbsp;</span>dropped<span style="font-family: inherit;">&nbsp;and another method used for exchanging data between Excel and shiny (direct file upload seems more elegant).</span></div><div><span style="font-family: inherit;"><br /></span></div><div><span style="font-family: inherit;"><br /></span></div></div>
<h2>Comments</h2>
<!--
<div class='comments'>
</div>
-->
