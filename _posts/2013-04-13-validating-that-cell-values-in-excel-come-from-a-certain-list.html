---
layout: post
title: Validating that cell values in Excel come from a certain list
date: 2013-04-13
comments: false
tags: code, dropdown, excel, validation
---

<!--
<h1>{{ page.title }}</h1>
-->
<div class='post'>
Still working on my Excel / R integration, but this post is mostly about Excel.<br /><br />Question: How to set up cell value validation in Excel, with the added twist that the valid values come from a separate Excel worksheet and can change (e.g. by user adding new values)?<br /><br />Concretely, I have one worksheet containing patient names and another worksheet containing data about the patients. Of course, the patient names should match on both worksheets, so we should only only allow entry of the names already present on the&nbsp;first&nbsp;worksheet into the second worksheet. &nbsp;The procedure is as follows.<br /><br />Create worksheet with patient names:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-BpbOAmiX8Jk/UWmqSM5ZH3I/AAAAAAAABTo/qD0XldvZbiM/s1600/validation1.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-BpbOAmiX8Jk/UWmqSM5ZH3I/AAAAAAAABTo/qD0XldvZbiM/s1600/validation1.PNG" /></a></div><br /><br />This list has to be created as a table - e.g. with the command "Format as table" (or something similar, as I do not have an English version of Excel - I do not recall the exact command). That is necessary, because a table "object" contains all the names in the list. And it will also contain any new names that we add to the list at the bottom (the table expands on its own).<br /><br />A table is&nbsp;automatically&nbsp;assigned a default name (e.g. "Table1"). We can browse a list of all named objects via the "Name manager" (or whatever it is called in the&nbsp;English&nbsp;version of Excel). This is it:<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-NCX62oMddy4/UWmskxMqS5I/AAAAAAAABTw/l4HnMoXoBKI/s1600/validation2.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-NCX62oMddy4/UWmskxMqS5I/AAAAAAAABTw/l4HnMoXoBKI/s640/validation2.PNG" height="172" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">In the "Name manager", create a New name (e.g. patientNames) that has as a reference value the&nbsp;table&nbsp;we just created. In my example I created a "patientsTable" label that references the "patientTable" table. &nbsp;The first has an icon of a label, the second an icon of a table in&nbsp;front&nbsp;of it, as can be seen in screenshot:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-vXeZ4yfQEC0/UWmzAeM1ilI/AAAAAAAABT4/LsThfDY2EgU/s1600/validation3.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-vXeZ4yfQEC0/UWmzAeM1ilI/AAAAAAAABT4/LsThfDY2EgU/s640/validation3.PNG" height="418" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">The one with the label icon in front will be the one we use in the next steps.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Next, mark the column which you want to control/validate (1 in screenshot bellow) and select the option to "validate data" (or its English equivalent) (2). Select a "List" as allowed values (3) and use the label "patientsTable" as source of validation (4). Make sure to include the "=" sign in front, as in the screenshot:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-q3tHsRoKL0k/UWm0VjB2KUI/AAAAAAAABUA/Q13iWIjOtBE/s1600/validation4.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-q3tHsRoKL0k/UWm0VjB2KUI/AAAAAAAABUA/Q13iWIjOtBE/s640/validation4.PNG" height="366" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Confirm. Now you should be able to choose only allowed values in the selected&nbsp;column&nbsp; with the help of a&nbsp;drop down&nbsp;menu that gets its values from the table of valid names. Just click on any cell in the column and a small triangle will appear:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-XukgYKiko5w/UWm1ctlonHI/AAAAAAAABUI/N9U3FVAZbg8/s1600/validation5.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-XukgYKiko5w/UWm1ctlonHI/AAAAAAAABUI/N9U3FVAZbg8/s1600/validation5.PNG" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Click the triangle and the drop down menu opens.&nbsp;</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">Adding values to the table of valid names should also refresh the options in the&nbsp;drop down. Cheers.</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">UPDATE 18.3.2014: How to reference only a certain column in the patientsTable? See instructions <a href="http://www.get-digital-help.com/2012/10/15/how-to-use-a-table-name-in-data-validation-lists-and-conditional-formatting-formulas/">here</a>. Bottom line, use this kind of referencing:</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-XyTv5jGRR4M/Uyg4olzAaNI/AAAAAAAABcQ/fltdY37sork/s1600/Referencing.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-XyTv5jGRR4M/Uyg4olzAaNI/AAAAAAAABcQ/fltdY37sork/s1600/Referencing.PNG" height="365" width="400" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><br /></div>
<h2>Comments</h2>
<!--
<div class='comments'>
</div>
-->
